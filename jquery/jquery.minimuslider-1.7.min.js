/* jquery.minimuslider v.1.7 | (c) 2012-18 Federica Sibella musings(at)musings(dot)it | http://www.musings.it | MIT license */
!function(t){function i(i){var n=t("#minimus-slide"+i.instance+"_"+i.current),e=n.find("img"),a=t.Deferred();if(e.length>0)if(void 0===e.attr("data-vscroll")){i.is_retina&&""!==e.attr("data-src-2x")&&void 0!==e.attr("data-src-2x")?e.attr("src")!==e.attr("data-src-2x")&&e.attr("src",e.attr("data-src-2x")):e.attr("src")!==e.attr("data-src")&&e.attr("src",e.attr("data-src"));var o=e,r=new Image;r.onload=function(){var t=r.width,o=r.height,s=o/t,c=i.slider,d=i.calc_width,m=i.calc_height,l=Math.round(d*s);if(a.resolve(l),e.attr("data-vscroll",l),"adjust"===i.options.ratio)n.css({height:l}),e.css({width:d,height:l}),c.css({height:l});else if(l>m){var u=Math.round((l-m)/2),h=0,v="auto";"top"===i.options.valign?h=0:"center"===i.options.valign?h=-u:"bottom"===i.options.valign&&(h="auto",v=0),e.css({width:d,height:l,top:h,bottom:v})}else{var f=Math.round(m/s),p=Math.round((f-d)/2);e.css({width:f,height:m,left:-p})}},r.src=o.attr("src"),0===n.find(".minimus-caption").length&&void 0!==e.attr("title")&&""!==e.attr("title")&&n.append("<div class='minimus-caption'><p>"+e.attr("title")+"</p></div>").promise().done(function(){var t=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-t}).delay(800).animate({bottom:0},300)})}else a.resolve(e.attr("data-vscroll"));else a.resolve(-1);return a.promise()}function n(i){var n=t("#minimus-slide"+i.instance+"_"+i.current);if(n.find(".minimus-caption").length>0){var e=n.find(".minimus-caption").outerHeight(!0);n.find(".minimus-caption").css({bottom:-e}).delay(800).animate({bottom:0},300)}}function e(i,n,e){var a=t("#minimus-slide"+i.instance+"_"+i.current),r=t("#minimus-slide"+i.instance+"_"+n),s=r.find("img"),c=i.options,d=i.calc_width,m=i.calc_height,l=0,u=0;switch("n"===e?(l=d+i.margin,u=m+i.margin):"p"===e&&(l=-(d+i.margin),u=-(m+i.margin)),c.animation_type){case"horizontal":a.css({left:l}).show(),r.animate({left:-l},c.animation_duration,function(){if(r.hide().toggleClass("active"),void 0!==s&&"none"!==c.vscroll&&"manual"===c.vscroll_start)switch(c.vscroll){case"up":s.css({bottom:0});break;case"down":s.css({top:0})}}),a.animate({left:0},c.animation_duration,function(){o(i)});break;case"vertical":a.css({top:u}).show(),r.animate({top:-u},c.animation_duration,function(){if(r.hide().toggleClass("active"),void 0!==s&&"none"!==c.vscroll&&"manual"===c.vscroll_start)switch(c.vscroll){case"up":s.css({bottom:0});break;case"down":s.css({top:0})}}),a.animate({top:0},c.animation_duration,function(){o(i)});break;case"fade":if(r.fadeOut(c.animation_duration).toggleClass("active"),void 0!==s&&"none"!==c.vscroll&&"manual"===c.vscroll_start)switch(c.vscroll){case"up":s.css({bottom:0});break;case"down":s.css({top:0})}a.fadeIn(c.animation_duration,function(){o(i)})}}function a(i){var n=t("#minimus-slide"+i.instance+"_"+i.current).find("img"),e=i.options,a=i.img_vheight-i.calc_height;if(void 0!==n&&0!==a)switch(e.valign){case"bottom":n.delay(800).animate({bottom:-a},e.vscroll_duration,function(){setTimeout(function(){"forward-jumpback"===e.vscroll_type?n.css({bottom:0}):"forward-backward"===e.vscroll_type&&n.animate({bottom:0},e.vscroll_duration)},1e3)});break;case"top":n.delay(800).animate({top:-a},e.vscroll_duration,function(){setTimeout(function(){"forward-jumpback"===e.vscroll_type?n.css({top:0}):"forward-backward"===e.vscroll_type&&n.animate({top:0},e.vscroll_duration)},1e3)})}}function o(i){var n=t("#minimus-slide"+i.instance+"_"+i.current);n.toggleClass("active"),i.lock=0}function r(i,n){var e,a=t("#minimus-slide"+i+"_"+n);a.children().is("audio,video")&&(e=a.children("audio,video"),e[0].paused===!1&&e[0].pause())}function s(t){if("string"==typeof t){var i=t.indexOf("_");-1!=i&&(t=t.substr(i+1))}return t}function c(t,i){var n=i,e=0,a=0;if("string"==typeof t){var o=t.indexOf("%");-1!=o&&(e=parseInt(t.slice(0,-1))/100,a=Math.round(n*e))}else a=t;return a}function d(n){var e=n.slider,a=n.parent,o=n.slide,r=n.min_width,s=n.min_height,d=n.slider_ratio,m=n.calc_width,l=n.calc_height;m=c(n.options.width,Math.min(a.width(),t(window).width())),t.when(i(n)).then(function(t){n.img_vheight=t}).then(function(){return l=Math.round(m*d),r>m&&(m=r,l=Math.round(m*d),s>l&&(l=s)),s>l&&(l=s,m=Math.round(l/d),r>m&&(m=r)),o.css({width:m,height:l}),o.children("video,iframe").css({width:m,height:l}),e.css({width:m,height:l}),n.calc_width=m,n.calc_height=l,n.slide=o,n.slider=e,n})}function m(t,i){var n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];return void 0===t.originalEvent.touches&&(n=t),i.ox=n.pageX,i.oy=n.pageY,i.startTime=(new Date).getTime(),i}function l(t,i){var n=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0];return void 0===t.originalEvent.touches&&(n=t),i.dx=n.pageX-i.ox,i.dy=n.pageY-i.oy,i.endTime=(new Date).getTime()-i.startTime,i}var u=[],h=0,v={init:function(n){this.each(function(){var e={width:"100%",height:"100%",ratio:.5625,animation_type:"horizontal",animation_duration:600,animation_start:"manual",animation_interval:4e3,width_reference:"",valign:"center",vscroll_type:"forward",vscroll_duration:5e3,vscroll_start:"none"},o=t(this),r=o.data("minimus"),s=t(),v=t(),f=t(),p=t(),g=t(),w=t(),_=t(),b=0,y=0,x=0,k=100,T=.565,M=0,D=0,z=320,C=180,P={},j=window.devicePixelRatio>1.3||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches,E=o.parent(),I=0;if(P.swipeTreshold=30,P.allowedTime=1e3,s=t.extend(e,n),o.attr("data-id","minimus-slider_"+h),v=o.find(".minimus-slide"),y=v.length-1,v.each(function(i){t(this).attr("id","minimus-slide"+h+"_"+i)}),f=o.next(".minimus-navslide"),p=f.find(".minimus-start").attr("data-id","minimus-start_"+h),g=f.find(".minimus-stop").attr("data-id","minimus-stop_"+h),w=f.find(".minimus-next").attr("data-id","minimus-next_"+h),_=f.find(".minimus-prev").attr("data-id","minimus-prev_"+h),void 0!==s.width_reference&&""!==s.width_reference&&(E=t("#"+s.width_reference)),M=c(s.width,E.width()),"number"==typeof s.ratio&&(T=s.ratio),D=Math.round(M*T),v.css({"box-sizing":"content-box",width:M,height:D,top:0,left:0}),void 0!==typeof v.children("img").attr("data-src")&&v.children("img").attr("src")!==v.children("img").attr("data-src")){var O=v.children("img").attr("src");v.children("img").css({background:"url("+O+") no-repeat center center"})}v.children("img,video,iframe").css({"box-sizing":"content-box",position:"absolute",top:0,left:0,width:M,height:D}),v.not(":first").hide(),v.filter(":first").addClass("active"),o.css({"box-sizing":"content-box",width:M,height:D}),v.length>1?(w.on("click touchstart touchend",function(i){i.stopPropagation(),i.preventDefault(),t(this).minimus("move","n")}),_.on("click touchstart touchend",function(i){i.stopPropagation(),i.preventDefault(),t(this).minimus("move","p")}),g.on("click",function(i){i.stopPropagation(),i.preventDefault(),o.minimus("stop"),t(this).hide(),p.show()}),p.on("click",function(i){i.stopPropagation(),i.preventDefault(),o.minimus("start"),t(this).hide(),g.show()}),o.on("touchstart.minimus",v.children("img,video,iframe"),function(i){i.stopPropagation(),i.preventDefault(),t(i.target).is("img,video,iframe")&&(P=m(i,P))}),o.on("touchend.minimus",v.children("img,video,iframe"),function(i){i.stopPropagation(),i.preventDefault(),t(i.target).is("img,video,iframe")&&(P=l(i,P),P.dx<-P.swipeTreshold&&P.endTime<P.allowedTime?o.minimus("move","n"):P.dx>P.swipeTreshold&&P.endTime<P.allowedTime&&o.minimus("move","p"))}),t(document).on("keydown.minimus",function(t){37==(t.keyCode||t.which)&&o.minimus("move","n"),39==(t.keyCode||t.which)&&o.minimus("move","p")})):f.hide(),"hover"===s.vscroll_start&&v.children("img").on("mouseenter",function(){a(r)}),o.data("minimus",{slider:o,parent:E,slide:v,totslides:y,margin:k,navslide:f,start:p,stop:g,prev:_,next:w,current:b,timer:x,options:s,instance:h,slider_ratio:T,calc_width:M,calc_height:D,min_width:z,min_height:C,mm:P,is_retina:j,lock:I,img_vheight:0}),r=o.data("minimus"),t.when(i(r)).then(function(t){r.img_vheight=t,u[h]=r}).then(function(){t.when(d(r)).then(function(){return"none"!==s.vscroll&&"auto"===s.vscroll_start&&a(r),"auto"==s.animation_start&&v.length>1?(g.show(),p.hide(),o.minimus("start")):"manual"==s.animation_start&&(o.minimus("stop"),g.hide(),p.hide()),h++,u})})})},move:function(o){var c=s(t(this).attr("data-id")),d=u[c],m=d.current;0===d.lock&&(d.lock=1,"n"===o?(d.current++,d.current>d.totslides&&(d.current=0)):"p"===o&&(d.current--,d.current<0&&(d.current=d.totslides)),r(c,m),t.when(i(d)).then(function(t){d.img_vheight=t,u[c]=d}).then(function(){return e(d,m,o),n(d),"none"!==d.options.vscroll&&"auto"===d.options.vscroll_start&&a(d),u[c]=d,u}))},resize:function(i){"number"!=typeof i&&(i=s(t(this).attr("data-id")));var n=u[i];void 0!==n&&t.when(d(n)).then(function(){return u[i]=n,u})},start:function(){var i=s(t(this).attr("data-id")),n=u[i],e=n.slider;return 0!==n.timer&&clearInterval(n.timer),n.timer=setInterval(function(){e.minimus("move","n")},n.options.animation_interval),u[i]=n,u},stop:function(){var i=s(t(this).attr("data-id")),n=u[i];return clearInterval(n.timer),u[i]=n,u},update:function(i){t(this).minimus("destroy"),t(this).minimus("init",i)},destroy:function(){var i=s(t(this).attr("data-id")),n=u[i];n.prev.off(),n.next.off(),n.slider.off("touchend.minimus"),t(document).off("keydown.minimus"),n.slider.minimus("stop"),n.slide.find("minimus-caption").remove(),t.removeData(n,"minimus"),this.unbind(),this.element=null}};t(window).resize(function(){setTimeout(function(){for(var i=0;h>i;i++)t.fn.minimus("resize",i)},100)}),t.fn.minimus=function(i){return v[i]?v[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.minimus"):v.init.apply(this,arguments)}}(jQuery);